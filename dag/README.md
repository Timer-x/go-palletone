
```
+------------------------------------------------------------------------------------------+
|                                                                                          |
|                                           Dag                                            |
|                                                                                          |
+--+-------------+-------------------+------------------------+---------------------+------+
   |             |                   |                        |                     |
   |             |                   |                        |                     |
   |             |                   |                        |                     |
   |             |                   |                        |                     |
+--v---+     +---v--+     +----------v---------+   +----------v--------+   +--------v------+
|      |     |      |     |                    +--->  UtxoRepository   |   |   Validator   |
|      +----->      +----->   UnitRepository   |   +-------------------+   +--------------++
|      |     |      |     |                    +---------------------------+              |
|      |     |      |     +------+----------+--------------+   |           |              |
|      |     |      |            |          |              |   |           |              |
|      |     |      |            |          |              |   |           |              |
|      |     |      |       +----v-----+  +-v-------+  +---v---v--+  +-----v----+         |
|TxPool|     |MemDag|       |  dagdb   |  |  idxdb  |  |  utxodb  |  |  statedb <---------+
|      |     |      |       +------+---+  +----+----+  +----+-----+  +-----+----+
|      |     |      |              |           |            |              |
|      |     |      |              |           |            |              |
|      |     |      |              |           |            |              |
|      |     |      |              |     +-----v------------v------+       |
|      |     |      |              |     |                         |       |
|      |     |      |              +---> |     ptndb.Database      | <-----+
|      |     |      |                    |                         |
+------+     +------+                    +-------------------------+

```
# TxPool交易池 与DAG的解耦
Dag中不引入任何TxPool的逻辑，DAG只专注于数据的存储和查询。DAG中发生了Unit的变化时，通过事件通知TxPool订阅者。
事件包括：
* 增加一个Unit到最新Unit的后面
* 回滚一个Unit到其父单元
* 将某个单元设置为稳定单元
# MemDag内存暂存单元
# LevelDB存储